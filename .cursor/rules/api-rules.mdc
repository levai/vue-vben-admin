---
alwaysApply: true
globs:
  - '**/api/**/*.ts'
  - '**/api/**/*.vue'
---

# API å®¢æˆ·ç«¯å¼€å‘è§„èŒƒ

> æœ¬æ–‡æ¡£æ˜¯ Vue Vben Admin é¡¹ç›®çš„ API å®¢æˆ·ç«¯å¼€å‘è§„èŒƒï¼ŒåŸºäº `@vben/request` åŒ…ã€‚

## ğŸ“‹ ç›®å½•

1. [HTTP å®¢æˆ·ç«¯æ¶æ„](#http-å®¢æˆ·ç«¯æ¶æ„)
2. [API å‡½æ•°å®šä¹‰è§„èŒƒ](#api-å‡½æ•°å®šä¹‰è§„èŒƒ)
3. [è¯·æ±‚æ‹¦æˆªå™¨æœºåˆ¶](#è¯·æ±‚æ‹¦æˆªå™¨æœºåˆ¶)
4. [å“åº”æ‹¦æˆªå™¨æœºåˆ¶](#å“åº”æ‹¦æˆªå™¨æœºåˆ¶)
5. [é”™è¯¯å¤„ç†è§„èŒƒ](#é”™è¯¯å¤„ç†è§„èŒƒ)
6. [ç±»å‹å®šä¹‰è§„èŒƒ](#ç±»å‹å®šä¹‰è§„èŒƒ)
7. [å®é™…ä½¿ç”¨ç¤ºä¾‹](#å®é™…ä½¿ç”¨ç¤ºä¾‹)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## HTTP å®¢æˆ·ç«¯æ¶æ„

### RequestClient åŸºç¡€

é¡¹ç›®ä½¿ç”¨ `@vben/request` åŒ…ä¸­çš„ `RequestClient`ï¼ŒåŸºäº Axios å°è£…ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š

- âœ… è‡ªåŠ¨å¤„ç†å“åº”æ•°æ®æ ¼å¼ï¼ˆ`code`/`data`/`message`ï¼‰
- âœ… è‡ªåŠ¨æ·»åŠ è®¤è¯ Token
- âœ… è‡ªåŠ¨åˆ·æ–° Tokenï¼ˆ401 é”™è¯¯æ—¶ï¼‰
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†
- âœ… BigInt æ”¯æŒï¼ˆè‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼‰
- âœ… å‚æ•°åºåˆ—åŒ–ï¼ˆRFC3986 æ ¼å¼ï¼‰

### å®¢æˆ·ç«¯å®ä¾‹

é¡¹ç›®æä¾›ä¸¤ä¸ªå®¢æˆ·ç«¯å®ä¾‹ï¼š

```typescript
// apps/web-antd/src/api/request.ts
import { RequestClient } from '@vben/request';

// æ ‡å‡†å®¢æˆ·ç«¯ï¼ˆå¸¦å®Œæ•´æ‹¦æˆªå™¨ï¼‰
export const requestClient = createRequestClient(apiURL, {
  responseReturn: 'data', // ç›´æ¥è¿”å› data å­—æ®µ
});

// åŸºç¡€å®¢æˆ·ç«¯ï¼ˆä»…åŸºç¡€æ‹¦æˆªå™¨ï¼Œç”¨äºç‰¹æ®Šåœºæ™¯ï¼‰
export const baseRequestClient = new RequestClient({
  baseURL: apiURL,
  responseReturn: 'data',
});
```

**ä½¿ç”¨åœºæ™¯**ï¼š

- `requestClient`: å¸¸è§„ API è°ƒç”¨ï¼ˆæ¨èï¼‰
- `baseRequestClient`: éœ€è¦åŸå§‹å“åº”çš„åœºæ™¯ï¼ˆå¦‚åˆ·æ–° Tokenï¼‰

---

## API å‡½æ•°å®šä¹‰è§„èŒƒ

### æ ‡å‡† API å‡½æ•°ç»“æ„

```typescript
// apps/web-antd/src/api/system/user.ts
import { requestClient } from '#/api/request';

// 1. å®šä¹‰å‘½åç©ºé—´å’Œç±»å‹
export namespace SystemUserApi {
  export interface SystemUser {
    id: string;
    username: string;
    realName?: string;
    status: 0 | 1;
    // ... å…¶ä»–å­—æ®µ
  }
}

// 2. å®šä¹‰ API å‡½æ•°ï¼ˆä½¿ç”¨ async functionï¼‰
/**
 * è·å–ç”¨æˆ·åˆ—è¡¨æ•°æ®
 */
async function getUserList(params: Recordable<any>) {
  return requestClient.get<{
    list: SystemUserApi.SystemUser[];
    total: number;
  }>('/system/user', { params });
}

// 3. å¯¼å‡ºå‡½æ•°
export { getUserList };
```

### HTTP æ–¹æ³•ä½¿ç”¨

```typescript
// GET è¯·æ±‚
async function getUserById(id: string) {
  return requestClient.get<SystemUserApi.SystemUser>(`/system/user/${id}`);
}

// POST è¯·æ±‚
async function createUser(data: Omit<SystemUserApi.SystemUser, 'id'>) {
  return requestClient.post('/system/user', data);
}

// PUT è¯·æ±‚
async function updateUser(id: string, data: Partial<SystemUserApi.SystemUser>) {
  return requestClient.put(`/system/user/${id}`, data);
}

// DELETE è¯·æ±‚
async function deleteUser(id: string) {
  return requestClient.delete(`/system/user/${id}`);
}
```

### ç±»å‹å®šä¹‰è§„èŒƒ

**âœ… æ­£ç¡®ï¼šä½¿ç”¨å‘½åç©ºé—´å¯¼å‡ºç±»å‹**

```typescript
export namespace SystemUserApi {
  export interface SystemUser {
    id: string;
    username: string;
  }

  export interface CreateUserParams {
    username: string;
    password: string;
  }
}

async function createUser(data: SystemUserApi.CreateUserParams) {
  return requestClient.post('/system/user', data);
}
```

**âŒ é”™è¯¯ï¼šç›´æ¥å¯¼å‡ºæ¥å£**

```typescript
// ä¸æ¨èï¼šç±»å‹å‘½åå¯èƒ½å†²çª
export interface User {
  id: string;
}
```

### å‡½æ•°å‘½åè§„èŒƒ

- **è·å–åˆ—è¡¨**: `get{Resource}List` (ä¾‹: `getUserList`)
- **è·å–è¯¦æƒ…**: `get{Resource}ById` (ä¾‹: `getUserById`)
- **åˆ›å»ºèµ„æº**: `create{Resource}` (ä¾‹: `createUser`)
- **æ›´æ–°èµ„æº**: `update{Resource}` (ä¾‹: `updateUser`)
- **åˆ é™¤èµ„æº**: `delete{Resource}` (ä¾‹: `deleteUser`)
- **è·å–é€‰é¡¹**: `get{Resource}Options` (ä¾‹: `getUserOptions`)

---

## è¯·æ±‚æ‹¦æˆªå™¨æœºåˆ¶

### è‡ªåŠ¨æ·»åŠ çš„è¯·æ±‚å¤´

è¯·æ±‚æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨æ·»åŠ ä»¥ä¸‹è¯·æ±‚å¤´ï¼š

```typescript
// apps/web-antd/src/api/request.ts
client.addRequestInterceptor({
  fulfilled: async (config) => {
    const accessStore = useAccessStore();

    // 1. è‡ªåŠ¨æ·»åŠ  Authorization Token
    config.headers.Authorization = formatToken(accessStore.accessToken);

    // 2. è‡ªåŠ¨æ·»åŠ è¯­è¨€æ ‡è¯†
    config.headers['Accept-Language'] = preferences.app.locale;

    // 3. è‡ªåŠ¨æ·»åŠ å½“å‰é¡µé¢ URLï¼ˆç”¨äºæ“ä½œæ—¥å¿—ï¼‰
    if (typeof window !== 'undefined') {
      const pageUrl = window.location.pathname;
      if (pageUrl) {
        config.headers['X-Page-Url'] = pageUrl;
      }
    }

    return config;
  },
});
```

**è¯´æ˜**ï¼š

- `Authorization`: Bearer Tokenï¼Œä» `useAccessStore` è·å–
- `Accept-Language`: å½“å‰è¯­è¨€è®¾ç½®
- `X-Page-Url`: å½“å‰é¡µé¢è·¯å¾„ï¼ˆç”¨äºåç«¯è®°å½•æ“ä½œæ—¥å¿—ï¼‰

### å‚æ•°åºåˆ—åŒ–

é¡¹ç›®ä½¿ç”¨ RFC3986 æ ¼å¼åºåˆ—åŒ–å‚æ•°ï¼Œç¡®ä¿ç©ºæ ¼è¢«ç¼–ç ä¸º `%20` è€Œä¸æ˜¯ `+`ï¼š

```typescript
const client = new RequestClient({
  baseURL,
  paramsSerializer: 'rfc3986-repeat', // RFC3986 æ ¼å¼ + repeat æ•°ç»„æ ¼å¼
});
```

**å‚æ•°åºåˆ—åŒ–é€‰é¡¹**ï¼š

- `rfc3986-repeat`: æ¨èä½¿ç”¨ï¼Œè§£å†³è¡¨å•æœç´¢æ—¶ç©ºæ ¼ç¼–ç é—®é¢˜
- `rfc3986`: RFC3986 æ ¼å¼ï¼Œç©ºæ ¼ç¼–ç ä¸º %20
- `repeat`: æ•°ç»„æ ¼å¼ `ids=1&ids=2&ids=3`
- `brackets`: æ•°ç»„æ ¼å¼ `ids[]=1&ids[]=2`
- `comma`: é€—å·åˆ†éš” `ids=1,2,3`

---

## å“åº”æ‹¦æˆªå™¨æœºåˆ¶

### å“åº”æ•°æ®æ ¼å¼

åç«¯ç»Ÿä¸€è¿”å›æ ¼å¼ï¼š

```typescript
interface HttpResponse<T = any> {
  code: number;    // 0 è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–è¡¨ç¤ºå¤±è´¥
  data: T;         // å®é™…æ•°æ®
  message: string; // é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶ï¼‰
}
```

### å“åº”æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº

1. **defaultResponseInterceptor**: å¤„ç†å“åº”æ•°æ®æ ¼å¼
2. **authenticateResponseInterceptor**: å¤„ç† Token åˆ·æ–°
3. **errorMessageResponseInterceptor**: ç»Ÿä¸€é”™è¯¯å¤„ç†

### defaultResponseInterceptor

è‡ªåŠ¨æå– `data` å­—æ®µï¼Œæ£€æŸ¥ `code` æ˜¯å¦ä¸ºæˆåŠŸçŠ¶æ€ï¼š

```typescript
client.addResponseInterceptor(
  defaultResponseInterceptor({
    codeField: 'code',      // å“åº”ä¸­çš„çŠ¶æ€ç å­—æ®µ
    dataField: 'data',      // å“åº”ä¸­çš„æ•°æ®å­—æ®µ
    successCode: 0,         // æˆåŠŸçŠ¶æ€ç 
  }),
);
```

**å“åº”è¿”å›æ¨¡å¼**ï¼š

- `responseReturn: 'data'`: ç›´æ¥è¿”å› `data` å­—æ®µï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰
- `responseReturn: 'body'`: è¿”å›å®Œæ•´å“åº”ä½“
- `responseReturn: 'raw'`: è¿”å›åŸå§‹ AxiosResponse

### authenticateResponseInterceptor

è‡ªåŠ¨å¤„ç† Token åˆ·æ–°é€»è¾‘ï¼š

```typescript
client.addResponseInterceptor(
  authenticateResponseInterceptor({
    client,
    doReAuthenticate,      // é‡æ–°è®¤è¯é€»è¾‘
    doRefreshToken,        // åˆ·æ–° Token é€»è¾‘
    enableRefreshToken: preferences.app.enableRefreshToken,
    formatToken,          // Token æ ¼å¼åŒ–å‡½æ•°
  }),
);
```

**å·¥ä½œæµç¨‹**ï¼š

1. æ£€æµ‹åˆ° 401 é”™è¯¯
2. å¦‚æœå¯ç”¨äº† refreshTokenï¼Œå°è¯•åˆ·æ–° Token
3. åˆ·æ–°æˆåŠŸåï¼Œè‡ªåŠ¨é‡è¯•åŸè¯·æ±‚
4. åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬ç™»å½•é¡µé¢

**Token åˆ·æ–°é˜Ÿåˆ—**ï¼š

- å¤šä¸ªè¯·æ±‚åŒæ—¶é‡åˆ° 401 æ—¶ï¼Œåªåˆ·æ–°ä¸€æ¬¡ Token
- å…¶ä»–è¯·æ±‚åŠ å…¥é˜Ÿåˆ—ï¼Œç­‰å¾…åˆ·æ–°å®Œæˆåé‡è¯•

---

## é”™è¯¯å¤„ç†è§„èŒƒ

### ç»Ÿä¸€é”™è¯¯å¤„ç†

`errorMessageResponseInterceptor` æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ï¼š

```typescript
client.addResponseInterceptor(
  errorMessageResponseInterceptor((msg: string, error) => {
    // ä¼˜å…ˆä½¿ç”¨åç«¯è¿”å›çš„é”™è¯¯ä¿¡æ¯
    const responseData = error?.response?.data ?? {};
    const errorMessage = responseData?.error ?? responseData?.message ?? '';

    // å¦‚æœæ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨é»˜è®¤æç¤º
    message.error(errorMessage || msg);
  }),
);
```

### é”™è¯¯ç±»å‹å¤„ç†

æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨å¤„ç†ä»¥ä¸‹é”™è¯¯ç±»å‹ï¼š

```typescript
// ç½‘ç»œé”™è¯¯
if (err?.includes('Network Error')) {
  errMsg = $t('ui.fallback.http.networkError');
}

// è¶…æ—¶é”™è¯¯
if (error?.message?.includes?.('timeout')) {
  errMsg = $t('ui.fallback.http.requestTimeout');
}

// HTTP çŠ¶æ€ç é”™è¯¯
switch (status) {
  case 400:
    errorMessage = $t('ui.fallback.http.badRequest');
    break;
  case 401:
    errorMessage = $t('ui.fallback.http.unauthorized');
    break;
  case 403:
    errorMessage = $t('ui.fallback.http.forbidden');
    break;
  case 404:
    errorMessage = $t('ui.fallback.http.notFound');
    break;
  case 408:
    errorMessage = $t('ui.fallback.http.requestTimeout');
    break;
  default:
    errorMessage = $t('ui.fallback.http.internalServerError');
}
```

### API å‡½æ•°ä¸­çš„é”™è¯¯å¤„ç†

**âœ… æ¨èï¼šè®©æ‹¦æˆªå™¨å¤„ç†é”™è¯¯**

```typescript
// æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨å¤„ç†é”™è¯¯ï¼Œæ— éœ€æ‰‹åŠ¨ try-catch
async function getUserList(params: Recordable<any>) {
  return requestClient.get('/system/user', { params });
}
```

**âœ… ç‰¹æ®Šåœºæ™¯ï¼šéœ€è¦è‡ªå®šä¹‰é”™è¯¯å¤„ç†**

```typescript
async function getUserList(params: Recordable<any>) {
  try {
    return await requestClient.get('/system/user', { params });
  } catch (error) {
    // è‡ªå®šä¹‰é”™è¯¯å¤„ç†é€»è¾‘
    console.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥:', error);
    throw error; // é‡æ–°æŠ›å‡ºï¼Œè®©æ‹¦æˆªå™¨å¤„ç†
  }
}
```

---

## ç±»å‹å®šä¹‰è§„èŒƒ

### å“åº”ç±»å‹å®šä¹‰

**âœ… æ­£ç¡®ï¼šæ˜ç¡®æŒ‡å®šå“åº”ç±»å‹**

```typescript
// å•ä¸ªå¯¹è±¡
async function getUserById(id: string) {
  return requestClient.get<SystemUserApi.SystemUser>(`/system/user/${id}`);
}

// åˆ—è¡¨æ•°æ®
async function getUserList(params: Recordable<any>) {
  return requestClient.get<{
    list: SystemUserApi.SystemUser[];
    total: number;
  }>('/system/user', { params });
}

// åˆ†é¡µæ•°æ®
async function getUserList(params: PageFetchParams) {
  return requestClient.get<{
    list: SystemUserApi.SystemUser[];
    total: number;
  }>('/system/user', { params });
}
```

**âŒ é”™è¯¯ï¼šä¸æŒ‡å®šç±»å‹**

```typescript
// ä¸æ¨èï¼šç¼ºå°‘ç±»å‹å®šä¹‰
async function getUserList(params: any) {
  return requestClient.get('/system/user', { params });
}
```

### è¯·æ±‚å‚æ•°ç±»å‹å®šä¹‰

**âœ… æ­£ç¡®ï¼šä½¿ç”¨æ¥å£å®šä¹‰å‚æ•°**

```typescript
export namespace SystemUserApi {
  export interface CreateUserParams {
    username: string;
    password: string;
    realName?: string;
    status?: 0 | 1;
  }
}

async function createUser(data: SystemUserApi.CreateUserParams) {
  return requestClient.post('/system/user', data);
}
```

**âœ… æ­£ç¡®ï¼šä½¿ç”¨ Omit/Partial å·¥å…·ç±»å‹**

```typescript
// åˆ›å»ºæ—¶æ’é™¤ idã€createTimeã€updateTime
async function createUser(
  data: Omit<SystemUserApi.SystemUser, 'id' | 'createTime' | 'updateTime'>,
) {
  return requestClient.post('/system/user', data);
}

// æ›´æ–°æ—¶ä½¿ç”¨ Partial
async function updateUser(
  id: string,
  data: Partial<Omit<SystemUserApi.SystemUser, 'id'>>,
) {
  return requestClient.put(`/system/user/${id}`, data);
}
```

---

## å®é™…ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´ API æ–‡ä»¶ç¤ºä¾‹

```typescript
// apps/web-antd/src/api/system/user.ts
import type { Recordable } from '@vben/types';

import { requestClient } from '#/api/request';

// 1. å®šä¹‰å‘½åç©ºé—´å’Œç±»å‹
export namespace SystemUserApi {
  export interface SystemUser {
    [key: string]: any;
    id: string;
    username: string;
    realName?: string;
    status: 0 | 1;
    createTime?: string;
    updateTime?: string;
  }
}

// 2. å®šä¹‰ API å‡½æ•°

/**
 * è·å–ç”¨æˆ·åˆ—è¡¨æ•°æ®
 */
async function getUserList(params: Recordable<any>) {
  return requestClient.get<{
    list: SystemUserApi.SystemUser[];
    total: number;
  }>('/system/user', { params });
}

/**
 * è·å–ç”¨æˆ·è¯¦æƒ…
 * @param id ç”¨æˆ·ID
 */
async function getUserById(id: string) {
  return requestClient.get<SystemUserApi.SystemUser>(`/system/user/${id}`);
}

/**
 * åˆ›å»ºç”¨æˆ·
 * @param data ç”¨æˆ·æ•°æ®
 */
async function createUser(
  data: Omit<SystemUserApi.SystemUser, 'id' | 'createTime' | 'updateTime'>,
) {
  return requestClient.post('/system/user', data);
}

/**
 * æ›´æ–°ç”¨æˆ·
 * @param id ç”¨æˆ·ID
 * @param data ç”¨æˆ·æ•°æ®
 */
async function updateUser(
  id: string,
  data: Partial<
    Omit<SystemUserApi.SystemUser, 'id' | 'createTime' | 'updateTime'>
  >,
) {
  return requestClient.put(`/system/user/${id}`, data);
}

/**
 * åˆ é™¤ç”¨æˆ·
 * @param id ç”¨æˆ·ID
 */
async function deleteUser(id: string) {
  return requestClient.delete(`/system/user/${id}`);
}

/**
 * è·å–ç”¨æˆ·é€‰é¡¹åˆ—è¡¨ï¼ˆç”¨äºä¸‹æ‹‰é€‰é¡¹ï¼‰
 * @param params æŸ¥è¯¢å‚æ•°ï¼ˆæ”¯æŒæ¡ä»¶æŸ¥è¯¢ã€åˆ†é¡µæˆ– limit é™åˆ¶ï¼‰
 */
async function getUserOptions(params?: {
  limit?: number;
  page?: number;
  pageSize?: number;
  search?: string;
  status?: number;
}) {
  return requestClient.get<{
    list: SystemUserApi.SystemUser[];
    total: number;
  }>('/system/user/options', {
    params,
  });
}

// 3. å¯¼å‡ºå‡½æ•°
export {
  createUser,
  deleteUser,
  getUserById,
  getUserList,
  getUserOptions,
  updateUser,
};
```

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ API

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { message } from 'ant-design-vue';
import { getUserList, createUser, deleteUser } from '#/api/system/user';
import type { SystemUserApi } from '#/api/system/user';

const loading = ref(false);
const userList = ref<SystemUserApi.SystemUser[]>([]);
const total = ref(0);

// è·å–ç”¨æˆ·åˆ—è¡¨
const fetchUserList = async () => {
  loading.value = true;
  try {
    const response = await getUserList({
      page: 1,
      pageSize: 10,
    });
    userList.value = response.list;
    total.value = response.total;
  } catch (error) {
    // é”™è¯¯å·²ç”±æ‹¦æˆªå™¨å¤„ç†ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ é¢å¤–é€»è¾‘
    console.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥:', error);
  } finally {
    loading.value = false;
  }
};

// åˆ›å»ºç”¨æˆ·
const handleCreate = async (data: SystemUserApi.SystemUser) => {
  try {
    await createUser(data);
    message.success('åˆ›å»ºæˆåŠŸ');
    await fetchUserList(); // åˆ·æ–°åˆ—è¡¨
  } catch (error) {
    // é”™è¯¯å·²ç”±æ‹¦æˆªå™¨å¤„ç†
  }
};

// åˆ é™¤ç”¨æˆ·
const handleDelete = async (id: string) => {
  try {
    await deleteUser(id);
    message.success('åˆ é™¤æˆåŠŸ');
    await fetchUserList(); // åˆ·æ–°åˆ—è¡¨
  } catch (error) {
    // é”™è¯¯å·²ç”±æ‹¦æˆªå™¨å¤„ç†
  }
};

onMounted(() => {
  fetchUserList();
});
</script>
```

### ç‰¹æ®Šåœºæ™¯ï¼šåˆ·æ–° Token

```typescript
// apps/web-antd/src/api/core/auth.ts
import { baseRequestClient } from '#/api/request';

/**
 * åˆ·æ–°accessToken
 * ä½¿ç”¨ baseRequestClient é¿å…è§¦å‘ token åˆ·æ–°å¾ªç¯
 */
export async function refreshTokenApi() {
  return baseRequestClient.post<string>('/auth/refresh', null, {
    withCredentials: true, // æºå¸¦ Cookie
  });
}
```

---

## æœ€ä½³å®è·µ

### 1. ç±»å‹å®‰å…¨

**âœ… æ¨èï¼šå®Œæ•´çš„ç±»å‹å®šä¹‰**

```typescript
export namespace SystemUserApi {
  export interface SystemUser {
    id: string;
    username: string;
  }
}

async function getUserById(id: string) {
  return requestClient.get<SystemUserApi.SystemUser>(`/system/user/${id}`);
}
```

**âŒ é¿å…ï¼šä½¿ç”¨ any**

```typescript
// ä¸æ¨è
async function getUserById(id: any) {
  return requestClient.get<any>(`/system/user/${id}`);
}
```

### 2. å‡½æ•°å‘½å

**âœ… æ¨èï¼šä½¿ç”¨åŠ¨è¯å‰ç¼€**

```typescript
getUserList    // è·å–åˆ—è¡¨
getUserById   // è·å–è¯¦æƒ…
createUser     // åˆ›å»º
updateUser     // æ›´æ–°
deleteUser     // åˆ é™¤
getUserOptions // è·å–é€‰é¡¹
```

### 3. é”™è¯¯å¤„ç†

**âœ… æ¨èï¼šè®©æ‹¦æˆªå™¨å¤„ç†é”™è¯¯**

```typescript
// æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨å¤„ç†é”™è¯¯å¹¶æ˜¾ç¤ºæç¤º
async function getUserList(params: Recordable<any>) {
  return requestClient.get('/system/user', { params });
}
```

**âœ… ç‰¹æ®Šåœºæ™¯ï¼šéœ€è¦è‡ªå®šä¹‰é”™è¯¯å¤„ç†**

```typescript
async function getUserList(params: Recordable<any>) {
  try {
    return await requestClient.get('/system/user', { params });
  } catch (error) {
    // è‡ªå®šä¹‰é”™è¯¯å¤„ç†
    if (error.response?.status === 403) {
      // æƒé™ä¸è¶³çš„ç‰¹æ®Šå¤„ç†
    }
    throw error; // é‡æ–°æŠ›å‡ºï¼Œè®©æ‹¦æˆªå™¨å¤„ç†
  }
}
```

### 4. å‚æ•°å®šä¹‰

**âœ… æ¨èï¼šä½¿ç”¨å¯é€‰å‚æ•°å’Œé»˜è®¤å€¼**

```typescript
async function getUserOptions(params?: {
  limit?: number;
  page?: number;
  pageSize?: number;
  search?: string;
}) {
  return requestClient.get('/system/user/options', { params });
}
```

### 5. æ–‡ä»¶ç»„ç»‡

**âœ… æ¨èï¼šæŒ‰æ¨¡å—ç»„ç»‡ API æ–‡ä»¶**

```
api/
â”œâ”€â”€ core/           # æ ¸å¿ƒ APIï¼ˆè®¤è¯ã€ç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰
â”‚   â”œâ”€â”€ auth.ts
â”‚   â””â”€â”€ user.ts
â”œâ”€â”€ system/         # ç³»ç»Ÿç®¡ç† API
â”‚   â”œâ”€â”€ user.ts
â”‚   â”œâ”€â”€ role.ts
â”‚   â””â”€â”€ menu.ts
â””â”€â”€ index.ts        # ç»Ÿä¸€å¯¼å‡º
```

### 6. å¯¼å‡ºè§„èŒƒ

**âœ… æ¨èï¼šä½¿ç”¨å‘½åå¯¼å‡º**

```typescript
// å¯¼å‡ºå‡½æ•°
export { getUserList, createUser, updateUser, deleteUser };

// å¯¼å‡ºç±»å‹ï¼ˆé€šè¿‡å‘½åç©ºé—´ï¼‰
export namespace SystemUserApi {
  export interface SystemUser { ... }
}
```

### 7. BigInt å¤„ç†

é¡¹ç›®å·²è‡ªåŠ¨å¤„ç† BigIntï¼Œæ— éœ€æ‰‹åŠ¨è½¬æ¢ï¼š

```typescript
// åç«¯è¿”å› BigInt ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²
const response = await getUserById('123');
console.log(response.id); // å­—ç¬¦ä¸²ç±»å‹ï¼Œå³ä½¿åç«¯è¿”å› BigInt
```

### 8. è¯·æ±‚å–æ¶ˆ

**âœ… æ¨èï¼šä½¿ç”¨ AbortController å–æ¶ˆè¯·æ±‚**

```typescript
const controller = new AbortController();

async function getUserList(params: Recordable<any>) {
  return requestClient.get('/system/user', {
    params,
    signal: controller.signal,
  });
}

// å–æ¶ˆè¯·æ±‚
controller.abort();
```

---

## ç¦æ­¢äº‹é¡¹

- âŒ ç¦æ­¢åœ¨ API å‡½æ•°ä¸­ä½¿ç”¨ `any` ç±»å‹
- âŒ ç¦æ­¢ç›´æ¥ä½¿ç”¨ `axios`ï¼ˆä½¿ç”¨ `requestClient`ï¼‰
- âŒ ç¦æ­¢åœ¨ API å‡½æ•°ä¸­æ‰‹åŠ¨å¤„ç†é”™è¯¯æç¤ºï¼ˆè®©æ‹¦æˆªå™¨å¤„ç†ï¼‰
- âŒ ç¦æ­¢åœ¨ API å‡½æ•°ä¸­æ‰‹åŠ¨æ·»åŠ  Tokenï¼ˆæ‹¦æˆªå™¨è‡ªåŠ¨å¤„ç†ï¼‰
- âŒ ç¦æ­¢ä½¿ç”¨ `baseRequestClient` è¿›è¡Œå¸¸è§„ API è°ƒç”¨ï¼ˆé™¤éç‰¹æ®Šåœºæ™¯ï¼‰

---

## æ€»ç»“

1. **ä½¿ç”¨ `requestClient`**: æ‰€æœ‰ API è°ƒç”¨ä½¿ç”¨ `requestClient`
2. **ç±»å‹å®šä¹‰**: ä½¿ç”¨å‘½åç©ºé—´å¯¼å‡ºç±»å‹ï¼Œæ˜ç¡®æŒ‡å®šå“åº”ç±»å‹
3. **é”™è¯¯å¤„ç†**: è®©æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œç‰¹æ®Šåœºæ™¯æ‰è‡ªå®šä¹‰
4. **å‡½æ•°å‘½å**: ä½¿ç”¨åŠ¨è¯å‰ç¼€ï¼ˆget/create/update/deleteï¼‰
5. **æ–‡ä»¶ç»„ç»‡**: æŒ‰æ¨¡å—ç»„ç»‡ API æ–‡ä»¶
6. **ç±»å‹å®‰å…¨**: é¿å…ä½¿ç”¨ `any`ï¼Œæä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰

---

**æœ€åæ›´æ–°**: 2024-12-19
